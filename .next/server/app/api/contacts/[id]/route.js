(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[401],{3567:(a,b,c)=>{"use strict";let d;c.r(b),c.d(b,{ComponentMod:()=>T,default:()=>U});var e,f={};c.r(f),c.d(f,{DELETE:()=>J,GET:()=>H,PUT:()=>I,runtime:()=>C});var g={};c.r(g),c.d(g,{handler:()=>Q,patchFetch:()=>P,routeModule:()=>L,serverHooks:()=>O,workAsyncStorage:()=>M,workUnitAsyncStorage:()=>N});var h=c(8796),i=c(2771),j=c(3169),k=c(6558),l=c(3015),m=c(5208),n=c(7840),o=c(8558),p=c(502),q=c(6568),r=c(9127),s=c(6306),t=c(2225),u=c(5087),v=c(5925),w=c(7491),x=c(9092),y=c(691),z=c(3779),A=c(4716),B=c(8020);let C="edge",D="contacts";async function E(){let a=await B.kv.get(D);if(!a)return[];try{let b=JSON.parse(a);return Array.isArray(b)?b:[]}catch{return[]}}async function F(a){await B.kv.put(D,JSON.stringify(a))}async function G(a){let{id:b}=await a.params;return b}async function H(a,b){let c=await E(),d=await G(b),e=c.find(a=>a.id===d);return e?A.Rp.json(e):A.Rp.json({error:"Contact not found"},{status:404})}async function I(a,b){let c=await E(),d=await G(b),e=c.findIndex(a=>a.id===d);if(-1===e)return A.Rp.json({error:"Contact not found"},{status:404});let f=await a.json(),g={...c[e],...f,id:d,updatedAt:new Date().toISOString()};return c[e]=g,await F(c),A.Rp.json(g)}async function J(a,b){let c=await E(),d=await G(b),e=c.filter(a=>a.id!==d);return e.length===c.length?A.Rp.json({error:"Contact not found"},{status:404}):(await F(e),A.Rp.json({ok:!0}))}var K=c(5356).Buffer;let L=new k.AppRouteRouteModule({definition:{kind:l.A.APP_ROUTE,page:"/api/contacts/[id]/route",pathname:"/api/contacts/[id]",filename:"route",bundlePath:"app/api/contacts/[id]/route"},distDir:process.env.__NEXT_RELATIVE_DIST_DIR||"",relativeProjectDir:process.env.__NEXT_RELATIVE_PROJECT_DIR||"",resolvedPagePath:"/Users/alihan/Documents/GitHub/crm-spr/app/api/contacts/[id]/route.ts",nextConfigOutput:"",userland:f}),{workAsyncStorage:M,workUnitAsyncStorage:N,serverHooks:O}=L;function P(){return(0,m.V5)({workAsyncStorage:M,workUnitAsyncStorage:N})}async function Q(a,b,c){L.isDev&&(0,n.Ul)(a,"devRequestTimingInternalsEnd",process.hrtime.bigint());let d="/api/contacts/[id]/route";"/index"===d&&(d="/");let e=await L.prepare(a,b,{srcPage:d,multiZoneDraftMode:!1});if(!e)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:f,params:g,nextConfig:j,parsedUrl:k,isDraftMode:m,prerenderManifest:A,routerServerContext:B,isOnDemandRevalidate:C,revalidateOnlyGenerated:D,resolvedPathname:E,clientReferenceManifest:F,serverActionsManifest:G}=e,H=(0,p.Y)(d),I=!!(A.dynamicRoutes[H]||A.routes[E]),J=async()=>((null==B?void 0:B.render404)?await B.render404(a,b,k,!1):b.end("This page could not be found"),null);if(I&&!m){let a=!!A.routes[E],b=A.dynamicRoutes[H];if(b&&!1===b.fallback&&!a){if(j.experimental.adapterPath)return await J();throw new y.G}}let M=null;!I||L.isDev||m||(M="/index"===(M=E)?"/":M);let N=!0===L.isDev||!I,O=I&&!N;G&&F&&(0,i.fQ)({page:d,clientReferenceManifest:F,serverActionsManifest:G,serverModuleMap:(0,h.e)({serverActionsManifest:G})});let P=a.method||"GET",Q=(0,o.EK)(),R=Q.getActiveScopeSpan(),S={params:g,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!j.experimental.authInterrupts},cacheComponents:!!j.cacheComponents,supportsDynamicResponse:N,incrementalCache:(0,n.Ny)(a,"incrementalCache"),cacheLifeProfiles:j.cacheLife,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>L.onRequestError(a,b,d,B)},sharedContext:{buildId:f}},T=new q.j(a),U=new q.p(b),V=r.u_.fromNodeNextRequest(T,(0,r.SN)(b));try{let e=async a=>L.handle(V,S).finally(()=>{if(!a)return;a.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=Q.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==s.Li.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=c.get("next.route");if(e){let b=`${P} ${e}`;a.setAttributes({"next.route":e,"http.route":e,"next.span_name":b}),a.updateName(b)}else a.updateName(`${P} ${d}`)}),f=!!(0,n.Ny)(a,"minimalMode"),g=async g=>{var h,i;let k=async({previousCacheEntry:h})=>{try{if(!f&&C&&D&&!h)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let d=await e(g);a.fetchMetrics=S.renderOpts.fetchMetrics;let i=S.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=S.renderOpts.collectedTags;if(!I)return await (0,u.I)(T,U,d,S.renderOpts.pendingWaitUntil),null;{let a=await d.blob(),b=(0,v.Cu)(d.headers);j&&(b[x.VC]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==S.renderOpts.collectedRevalidate&&!(S.renderOpts.collectedRevalidate>=x.AR)&&S.renderOpts.collectedRevalidate,e=void 0===S.renderOpts.collectedExpire||S.renderOpts.collectedExpire>=x.AR?void 0:S.renderOpts.collectedExpire;return{value:{kind:z.yD.APP_ROUTE,status:d.status,body:K.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:e}}}}catch(b){throw(null==h?void 0:h.isStale)&&await L.onRequestError(a,b,{routerKind:"App Router",routePath:d,routeType:"route",revalidateReason:(0,t.c)({isStaticGeneration:O,isOnDemandRevalidate:C})},B),b}},n=await L.handleResponse({req:a,nextConfig:j,cacheKey:M,routeKind:l.A.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:D,responseGenerator:k,waitUntil:c.waitUntil,isMinimalMode:f});if(!I)return null;if((null==n||null==(h=n.value)?void 0:h.kind)!==z.yD.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==n||null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});f||b.setHeader("x-nextjs-cache",C?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),m&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let o=(0,v.p$)(n.value.headers);return f&&I||o.delete(x.VC),!n.cacheControl||b.getHeader("Cache-Control")||o.get("Cache-Control")||o.set("Cache-Control",(0,w.B)(n.cacheControl)),await (0,u.I)(T,U,new Response(n.value.body,{headers:o,status:n.value.status||200})),null};R?await g(R):await Q.withPropagatedContext(a.headers,()=>Q.trace(s.Li.handleRequest,{spanName:`${P} ${d}`,kind:o.v8.SERVER,attributes:{"http.method":P,"http.target":a.url}},g))}catch(b){if(b instanceof y.G||await L.onRequestError(a,b,{routerKind:"App Router",routePath:H,routeType:"route",revalidateReason:(0,t.c)({isStaticGeneration:O,isOnDemandRevalidate:C})}),I)throw b;return await (0,u.I)(T,U,new Response(null,{status:500})),null}}let R=null==(e=self.__RSC_MANIFEST)?void 0:e["/api/contacts/[id]/route"],S=(d=self.__RSC_SERVER_MANIFEST)?JSON.parse(d):void 0;R&&S&&(0,i.fQ)({page:"/api/contacts/[id]/route",clientReferenceManifest:R,serverActionsManifest:S,serverModuleMap:(0,h.e)({serverActionsManifest:S})});let T=g,U=j.s.wrap(L,{nextConfig:{env:{},webpack:null,typescript:{ignoreBuildErrors:!1},typedRoutes:!1,distDir:".next",cleanDistDir:!0,assetPrefix:"",cacheMaxMemorySize:0x3200000,configOrigin:"next.config.mjs",useFileSystemPublicRoutes:!0,generateEtags:!0,pageExtensions:["tsx","ts","jsx","js"],poweredByHeader:!0,compress:!0,images:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:[{pathname:"**",search:""}],remotePatterns:[],qualities:[75],unoptimized:!1},devIndicators:{position:"bottom-left"},onDemandEntries:{maxInactiveAge:6e4,pagesBufferLength:5},basePath:"",sassOptions:{},trailingSlash:!1,i18n:null,productionBrowserSourceMaps:!1,excludeDefaultMomentLocales:!0,reactProductionProfiling:!1,reactStrictMode:!0,reactMaxHeadersLength:6e3,httpAgentOptions:{keepAlive:!0},logging:{},compiler:{},expireTime:31536e3,staticPageGenerationTimeout:60,modularizeImports:{"@mui/icons-material":{transform:"@mui/icons-material/{{member}}"},lodash:{transform:"lodash/{{member}}"}},outputFileTracingRoot:"/Users/alihan/Documents/GitHub/crm-spr",cacheComponents:!1,cacheLife:{default:{stale:300,revalidate:900,expire:0xfffffffe},seconds:{stale:30,revalidate:1,expire:60},minutes:{stale:300,revalidate:60,expire:3600},hours:{stale:300,revalidate:3600,expire:86400},days:{stale:300,revalidate:86400,expire:604800},weeks:{stale:300,revalidate:604800,expire:2592e3},max:{stale:300,revalidate:2592e3,expire:31536e3}},cacheHandlers:{},experimental:{useSkewCookie:!1,cssChunking:!0,multiZoneDraftMode:!1,appNavFailHandling:!1,prerenderEarlyExit:!0,serverMinification:!0,serverSourceMaps:!1,linkNoTouchStart:!1,caseSensitiveRoutes:!1,clientSegmentCache:!0,dynamicOnHover:!1,preloadEntriesOnStart:!0,clientRouterFilter:!0,clientRouterFilterRedirects:!1,fetchCacheKeyPrefix:"",proxyPrefetch:"flexible",optimisticClientCache:!0,manualClientBasePath:!1,cpus:7,memoryBasedWorkersCount:!1,imgOptConcurrency:null,imgOptTimeoutInSeconds:7,imgOptMaxInputPixels:0xfff8001,imgOptSequentialRead:null,imgOptSkipMetadata:null,isrFlushToDisk:!0,workerThreads:!1,optimizeCss:!1,nextScriptWorkers:!1,scrollRestoration:!1,externalDir:!1,disableOptimizedLoading:!1,gzipSize:!0,craCompat:!1,esmExternals:!0,fullySpecified:!1,swcTraceProfiling:!1,forceSwcTransforms:!1,largePageDataBytes:128e3,typedEnv:!1,parallelServerCompiles:!1,parallelServerBuildTraces:!1,ppr:!1,authInterrupts:!1,webpackMemoryOptimizations:!1,optimizeServerReact:!0,viewTransition:!1,removeUncaughtErrorAndRejectionListeners:!1,validateRSCRequestHeaders:!1,staleTimes:{dynamic:0,static:300},reactDebugChannel:!1,serverComponentsHmrCache:!0,staticGenerationMaxConcurrency:8,staticGenerationMinPagesPerWorker:25,inlineCss:!1,useCache:!1,globalNotFound:!1,browserDebugInfoInTerminal:!1,lockDistDir:!0,isolatedDevBuild:!0,proxyClientMaxBodySize:0xa00000,hideLogsAfterAbort:!1,mcpServer:!0,optimizePackageImports:["lucide-react","date-fns","lodash-es","ramda","antd","react-bootstrap","ahooks","@ant-design/icons","@headlessui/react","@headlessui-float/react","@heroicons/react/20/solid","@heroicons/react/24/solid","@heroicons/react/24/outline","@visx/visx","@tremor/react","rxjs","@mui/material","@mui/icons-material","recharts","react-use","effect","@effect/schema","@effect/platform","@effect/platform-node","@effect/platform-browser","@effect/platform-bun","@effect/sql","@effect/sql-mssql","@effect/sql-mysql2","@effect/sql-pg","@effect/sql-sqlite-node","@effect/sql-sqlite-bun","@effect/sql-sqlite-wasm","@effect/sql-sqlite-react-native","@effect/rpc","@effect/rpc-http","@effect/typeclass","@effect/experimental","@effect/opentelemetry","@material-ui/core","@material-ui/icons","@tabler/icons-react","mui-core","react-icons/ai","react-icons/bi","react-icons/bs","react-icons/cg","react-icons/ci","react-icons/di","react-icons/fa","react-icons/fa6","react-icons/fc","react-icons/fi","react-icons/gi","react-icons/go","react-icons/gr","react-icons/hi","react-icons/hi2","react-icons/im","react-icons/io","react-icons/io5","react-icons/lia","react-icons/lib","react-icons/lu","react-icons/md","react-icons/pi","react-icons/ri","react-icons/rx","react-icons/si","react-icons/sl","react-icons/tb","react-icons/tfi","react-icons/ti","react-icons/vsc","react-icons/wi"]},htmlLimitedBots:"[\\w-]+-Google|Google-[\\w-]+|Chrome-Lighthouse|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|Yeti|googleweblight",bundlePagesRouterDependencies:!1,configFile:"/Users/alihan/Documents/GitHub/crm-spr/next.config.mjs",configFileName:"next.config.mjs",turbopack:{root:"/Users/alihan/Documents/GitHub/crm-spr"},distDirRoot:".next"}})},5356:a=>{"use strict";a.exports=require("node:buffer")},5521:a=>{"use strict";a.exports=require("node:async_hooks")},5681:()=>{},8020:(a,b,c)=>{"use strict";c.d(b,{kv:()=>f});let d=new Map;async function e(a){if("string"==typeof a)return a;if("object"==typeof a&&null!==a){if(a instanceof ArrayBuffer)return new TextDecoder().decode(new Uint8Array(a));if(ArrayBuffer.isView(a))return new TextDecoder().decode(new Uint8Array(a.buffer));if("undefined"!=typeof FormData&&a instanceof FormData){let b=new URLSearchParams;for(let[c,d]of a.entries())"string"==typeof d&&b.append(c,d);return b.toString()}if("undefined"!=typeof URLSearchParams&&a instanceof URLSearchParams)return a.toString();if("undefined"!=typeof Blob&&a instanceof Blob)return await a.text();if(a instanceof ReadableStream){let b=a.getReader(),c=[];for(;;){let{done:a,value:d}=await b.read();if(a)break;d&&c.push(d)}if(0===c.length)return"";let d=new Uint8Array(c.reduce((a,b)=>a+b.length,0)),e=0;for(let a of c)d.set(a,e),e+=a.length;return new TextDecoder().decode(d)}}throw Error("In-memory KV fallback only supports string-compatible values. Provide CRM_SPR_KV binding for other types.")}let f=function(){if("object"==typeof globalThis&&"CRM_SPR_KV"in globalThis){let a=globalThis.CRM_SPR_KV;if(a)return a}}()??{get:async a=>d.get(a)??null,getWithMetadata:async a=>({value:d.get(a)??null,metadata:null}),async put(a,b){let c=await e(b);d.set(a,c)},async delete(a){d.delete(a)},async list(a){let b=a?.prefix??"";return{keys:Array.from(d.keys()).filter(a=>a.startsWith(b)).map(a=>({name:a})),list_complete:!0,cursor:void 0}}}},8833:()=>{}},a=>{a.O(0,[577],()=>a(a.s=3567));var b=a.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/contacts/[id]/route"]=b}]);
//# sourceMappingURL=route.js.map